<!-- templates/hockey/widget.html -->
<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <link rel="stylesheet" href="/static/widget.css" />
    <div class="title">{{ team_code or "MN Wild" }}</div>
  </head>

  <body data-theme="{{ theme }}">
    <div class="ticker">
      <div class="header">
        <div class="title">Minnesota Wild</div>
        <div class="sub">Updated {{ now.strftime("%-I:%M %p") }}</div>
      </div>

      <!-- Upcoming -->
      <div class="section">
        <div class="section-title">Upcoming</div>

        {% if upcoming|length == 0 %}
          <div class="empty">No upcoming games found.</div>
        {% endif %}

        {% for g in upcoming %}
          <div class="row">
            <div class="left">
              <div class="line1">{{ g.date_str }} · {{ g.time_str }}</div>
              <div class="line2">{{ g.homeaway }} {{ g.opponent }}</div>
            </div>

            <div class="right net-wrap">
              {% if g.networks and g.networks|length > 0 %}
                <div class="net">{{ g.networks|join(", ") }}</div>
              {% else %}
                <div class="net muted">TV: unknown</div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Recent -->
      <div class="section">
        <div class="section-title">Recent</div>

        {% if recent|length == 0 %}
          <div class="empty">No recent games found.</div>
        {% endif %}

        {% for g in recent %}
          <div class="row">
            <div class="left">
              <div class="line1">{{ g.date_str }}</div>
              <div class="line2">{{ g.homeaway }} {{ g.opponent }}</div>
            </div>
            <div class="right score-inline">
              {% if g.score %}
                {% if g.is_live %}
                  <span class="live-pill">
                    <span class="live-dot"></span>
                    LIVE{% if g.live_label %} {{ g.live_label }}{% endif %}
                  </span>
                  <span class="score-num">{{ g.score }}</span>
                {% else %}
                  <span class="wl
                    {% if g.result == 'W' %}wl-win{% elif g.result == 'L' %}wl-loss{% else %}wl-muted{% endif %}
                  ">
                    {{ g.result or "—" }}
                  </span>
                  <span class="score-num">{{ g.score }}</span>
                {% endif %}
              {% else %}
                <div class="score muted">Score: n/a</div>
              {% endif %}
            </div>
          </div>
        {% endfor %}
      </div>

      <!-- Standings -->
      {% if standings %}
      <div class="section standings">
        <div class="section-title">
          {{ division }} Division
        </div>

        <table class="standings-table">
          <thead>
            <tr>
              <th>Team</th>
              <th>GP</th>
              <th>W</th>
              <th>L</th>
              <th>OT</th>
              <th>Pts</th>
              <th>RW</th>
              <th>ROW</th>
              <th>Strk</th>
              <th>+/-</th>
              <th>GF</th>
              <th>GA</th>
              <th>Home</th>
              <th>Away</th>
            </tr>
          </thead>
          <tbody>
            {% for t in standings %}
              <tr class="{% if t.abbr == 'MIN' %}highlight{% endif %}">
                <td class="team">{{ t.abbr }}</td>
                <td>{{ t.gp }}</td>
                <td>{{ t.w }}</td>
                <td>{{ t.l }}</td>
                <td>{{ t.otl }}</td>
                <td class="pts">{{ t.pts }}</td>
                <td>{{ t.rw }}</td>
                <td>{{ t.row }}</td>

                <td class="strk
                  {% if t.strk and t.strk.startswith('W') %}strk-win
                  {% elif t.strk and t.strk.startswith('L') %}strk-loss
                  {% elif t.strk and (t.strk.startswith('O') or t.strk.startswith('T')) %}strk-ot
                  {% else %}strk-neutral{% endif %}
                ">
                  {{ t.strk }}
                </td>

                <td class="{% if t.dif > 0 %}pos{% elif t.dif < 0 %}neg{% endif %}">
                  {{ t.dif }}
                </td>
                <td>{{ t.gf }}</td>
                <td>{{ t.ga }}</td>
                <td>{{ t.home or "—" }}</td>
                <td>{{ t.away or "—" }}</td>
              </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% endif %}
    </div>
  </body>
</html>
